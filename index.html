<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>

<body>

    <div class="container">
        <div class="tab-container">
            <button onclick="openTab('Accueil')">Accueil</button>
            <button onclick="openTab('Historique')">Historique</button>
            <button onclick="openTab('Carte')">Carte</button>
        </div>

        <div id="Accueil" class="tab-content">
            <div class="widget-container">
                <div id="weather-widget blur">
                    <h2>Météo</h2>
                    <div class="widget-box">
                        <p class="temperature">25°C</p>
                        <p class="humidity">60%</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="Historique" class="tab-content" style="display:none;">
            <div id="historique-chart">
                <canvas id="historiqueCanvas"></canvas>
            </div>
            <button id="generateButton" onclick="generateData()">Générer des données</button>
            <button id="shareButton" onclick="shareData()">Partager les données</button>
            <script>
                config = {
                    type: "line", // Graphique de type Line
                    data: {
                        labels: [], // Données Axe X
                        datasets: [{
                            label: "Température °C", // Titre du jeu de données
                            fill: false, // Juste un trait pour le tracé de la courbe
                            backgroundColor: "red", // Couleur des points
                            borderColor: "red", // Couleur du trait
                            data: [] // Données Axe Y
                        },
                        {
                            label: "Humidité %", // Title of the new dataset
                            fill: false, // Just a line for the plot
                            backgroundColor: "blue", // Color of the points
                            borderColor: "blue", // Color of the line
                            data: [] // Data for Y Axis
                        }]
                    },
                    options: {
                        scales: {
                            xAxes: [{
                                scaleLabel: { // Titre sur l'axe X
                                    display: true,
                                    labelString: "Temps"
                                }
                            }],
                            yAxes: [{
                                scaleLabel: { // Titre sur l'axe Y
                                    display: true,
                                    labelString: "°C"
                                }
                            }]
                        }
                    }
                };


                /*Le contexte du canevas HTML */
                context = document.getElementById("historiqueCanvas").getContext("2d");
                chart = new Chart(context, config);

                /* Générer des données aléatoires */
                function generateData() {
                    randomTemperature = (Math.random() * Math.floor(50)).toFixed(2); // Deux chiffres après la virgule
                    addTemperature(new Date().toLocaleTimeString(), randomTemperature);
                }

                function addTemperature(time, temperature) {
                    /* Ajoute la valeur en X */
                    config.data.labels.push(time);

                    /* Ajoute la valeur */
                    config.data.datasets[0].data.push(temperature);

                    /* Rafraichir le graphique */
                    chart.update();
                }

                function shareData() {
                    // Logique pour partager les données
                    
                }
            </script>
        </div>

        <div id="Carte" class="tab-content" style="display:none;">
            <div id="map">
                <script>
                 map = L.map('map').setView([43.48148903216487, 5.386199013387367], 13);

                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);   
                </script> 
            </div>
        </div>

        <div id="chart-container" class="tab-content" style="display:none;">
            <button id="shareButton" onclick="shareData()">Partager les données</button>
        </div>
    </div>

    <script>
        function openTab(tabName) {
            var i, tabContent;
            tabContent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabContent.length; i++) {
                tabContent[i].style.display = "none";
            }
            document.getElementById(tabName).style.display = "block";
        }
    </script>

</body>
</html>